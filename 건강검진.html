<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ì–‘ ìƒíƒœ ìê°€ì§„ë‹¨ ëŒ€ì‹œë³´ë“œ</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Chosen Palette: Warm Neutrals & Calming Earth Tones -->
    <!-- Background: #FDFBF7 (Cream) -->
    <!-- Primary Text: #2D3748 (Dark Slate) -->
    <!-- Accents: #48BB78 (Soft Green), #ED8936 (Muted Orange), #E53E3E (Soft Red) -->
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Noto Sans KR"', 'sans-serif'],
                    },
                    colors: {
                        neutral: {
                            50: '#FDFBF7',
                            100: '#F7F5F0',
                            200: '#E2E8F0',
                            800: '#2D3748',
                            900: '#1A202C',
                        },
                        brand: {
                            green: '#48BB78',
                            yellow: '#ECC94B',
                            orange: '#ED8936',
                            red: '#E53E3E',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #FDFBF7;
            color: #2D3748;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px; 
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .option-btn {
            transition: all 0.2s ease-in-out;
        }
        .option-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .selected-option {
            background-color: #2D3748;
            color: white;
            border-color: #2D3748;
        }
    </style>
</head>
<body class="font-sans antialiased min-h-screen flex flex-col">

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold tracking-tight text-neutral-800 flex items-center gap-2">
                <span>ğŸ¥—</span> ì˜ì–‘ ë°¸ëŸ°ìŠ¤ ì²´í¬
            </h1>
            <div class="text-sm text-neutral-500 hidden sm:block">
                ë‹¹ì‹ ì˜ ì‹ìŠµê´€ì„ ì ê²€í•´ë³´ì„¸ìš”
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Application Structure Plan: 
             1. Intro Section: Sets context and invites user to start.
             2. Assessment Section: A clean, list-based form for the 20 questions. Grouped visually for readability but presented linearly for flow.
             3. Dashboard Section (Hidden initially): Reveals upon submission. Contains:
                - Overall Score Gauge (Immediate feedback).
                - Risk Radar Chart (Detailed nutrient breakdown).
                - Actionable Advice Cards (Textual guidance).
             Rationale: A linear flow prevents overwhelming the user with data before input. The dashboard synthesizes the 20 points into actionable visual insights.
        -->

        <!-- Intro View -->
        <div id="intro-view" class="max-w-3xl mx-auto text-center space-y-8 py-12 animate-fade-in">
            <div class="bg-white p-8 rounded-2xl shadow-lg border border-neutral-100">
                <h2 class="text-3xl font-bold mb-4 text-neutral-900">ë‹¹ì‹ ì˜ ì˜ì–‘ ìƒíƒœ, ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ?</h2>
                <p class="text-lg text-neutral-600 mb-8 leading-relaxed">
                    ë³¸ ì„¤ë¬¸ì€ ì´ 20ë¬¸í•­ìœ¼ë¡œ êµ¬ì„±ëœ ê°„ë‹¨í•œ ìê°€ì§„ë‹¨ ë„êµ¬ì…ë‹ˆë‹¤.<br>
                    í‰ì†Œ ì‹ìŠµê´€ì„ í†µí•´ ì˜ì–‘ ë¶ˆê· í˜• ê°€ëŠ¥ì„±ê³¼ ë¶€ì¡±í•œ ì˜ì–‘ì†Œë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.
                </p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10 text-left">
                    <div class="p-4 bg-green-50 rounded-lg border border-green-100">
                        <div class="font-bold text-brand-green mb-1">01. ìê°€ì§„ë‹¨</div>
                        <div class="text-sm text-neutral-600">ì‹ìŠµê´€ê³¼ ìƒí™œ íŒ¨í„´ì— ê´€í•œ 20ê°€ì§€ ì§ˆë¬¸ì— ë‹µí•©ë‹ˆë‹¤.</div>
                    </div>
                    <div class="p-4 bg-orange-50 rounded-lg border border-orange-100">
                        <div class="font-bold text-brand-orange mb-1">02. ìœ„í—˜ë„ ë¶„ì„</div>
                        <div class="text-sm text-neutral-600">ì „ì²´ ê±´ê°• ì ìˆ˜ì™€ ì£¼ìš” ì˜ì–‘ì†Œ ê²°í• ìœ„í—˜ì„ ë¶„ì„í•©ë‹ˆë‹¤.</div>
                    </div>
                    <div class="p-4 bg-red-50 rounded-lg border border-red-100">
                        <div class="font-bold text-brand-red mb-1">03. í–‰ë™ ê°€ì´ë“œ</div>
                        <div class="text-sm text-neutral-600">ì ìˆ˜ëŒ€ì— ë§ëŠ” êµ¬ì²´ì ì¸ ê°œì„  ë°©ì•ˆì„ ì œì•ˆí•©ë‹ˆë‹¤.</div>
                    </div>
                </div>

                <button onclick="startSurvey()" class="bg-neutral-800 hover:bg-neutral-900 text-white font-bold py-4 px-10 rounded-full shadow-lg transition transform hover:scale-105 text-lg">
                    ì§„ë‹¨ ì‹œì‘í•˜ê¸°
                </button>
                <p class="mt-4 text-xs text-neutral-400">* ì´ ê²°ê³¼ëŠ” ì˜í•™ì  ì§„ë‹¨ì´ ì•„ë‹ˆë©° ì°¸ê³ ìš©ì…ë‹ˆë‹¤.</p>
            </div>
        </div>

        <!-- Survey View -->
        <div id="survey-view" class="hidden max-w-4xl mx-auto">
            <div class="mb-6">
                <div class="w-full bg-neutral-200 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-brand-green h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <div class="text-right text-sm text-neutral-500 mt-2">
                    ì§„í–‰ë¥ : <span id="progress-text">0/20</span>
                </div>
            </div>

            <div id="questions-container" class="space-y-6">
                <!-- Questions will be injected here by JS -->
            </div>

            <div class="mt-8 text-center">
                <button id="submit-btn" onclick="calculateAndShowResults()" class="hidden bg-neutral-800 hover:bg-neutral-900 text-white font-bold py-4 px-12 rounded-full shadow-lg transition transform hover:scale-105 text-lg">
                    ê²°ê³¼ ë¶„ì„í•˜ê¸°
                </button>
                <p id="incomplete-msg" class="text-brand-orange mt-2 hidden font-medium">ëª¨ë“  ë¬¸í•­ì— ë‹µë³€í•´ì£¼ì„¸ìš”.</p>
            </div>
        </div>

        <!-- Dashboard Result View -->
        <div id="dashboard-view" class="hidden max-w-6xl mx-auto space-y-8">
            
            <!-- Result Header -->
            <div class="bg-white p-6 rounded-xl shadow-md border border-neutral-100">
                <h2 class="text-2xl font-bold text-neutral-800 mb-2">ì§„ë‹¨ ê²°ê³¼ ë³´ê³ ì„œ</h2>
                <p class="text-neutral-600">ê·€í•˜ì˜ ë‹µë³€ì„ ë°”íƒ•ìœ¼ë¡œ ë¶„ì„ëœ ì˜ì–‘ ìƒíƒœ ê°œìš”ì…ë‹ˆë‹¤.</p>
            </div>

            <!-- Dashboard Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                
                <!-- Visualization & Content Choices: 
                     1. Total Score Gauge: A visual "speedometer" is intuitive for risk assessment.
                     2. Status Card: Large text explanation of the score tier.
                -->
                <!-- Overall Score Section -->
                <div class="bg-white p-6 rounded-xl shadow-lg border border-neutral-100 flex flex-col">
                    <h3 class="text-lg font-bold text-neutral-700 mb-4 border-b pb-2">ì¢…í•© ì˜ì–‘ ìœ„í—˜ë„</h3>
                    <div class="flex-grow flex flex-col items-center justify-center py-4">
                        <div class="chart-container relative">
                            <canvas id="scoreChart"></canvas>
                            <!-- Score Overlay -->
                            <div class="absolute inset-0 flex items-center justify-center flex-col pt-16 pointer-events-none">
                                <span id="total-score-display" class="text-5xl font-extrabold text-neutral-800">0</span>
                                <span class="text-sm text-neutral-500">/ 40ì </span>
                            </div>
                        </div>
                    </div>
                    <div id="score-message-container" class="mt-4 p-4 rounded-lg bg-neutral-50 text-center">
                        <!-- Dynamic Status Message -->
                    </div>
                </div>

                <!-- Visualization & Content Choices:
                     3. Risk Radar Chart: Uses the "Specific Risk Groups" data logic to map vulnerabilities on a radar chart. This allows users to see shape of their diet issues (e.g., "Protein deficient" vs "Sugar heavy").
                -->
                <!-- Specific Risk Analysis -->
                <div class="bg-white p-6 rounded-xl shadow-lg border border-neutral-100 flex flex-col">
                    <h3 class="text-lg font-bold text-neutral-700 mb-4 border-b pb-2">ì·¨ì•½ ì˜ì–‘ì†Œ ìƒì„¸ ë¶„ì„</h3>
                    <p class="text-sm text-neutral-500 mb-4">
                        íŠ¹ì • ë¬¸í•­ íŒ¨í„´ì„ ë¶„ì„í•˜ì—¬ ê²°í•ì´ ì˜ì‹¬ë˜ëŠ” ì˜ì–‘ì†Œ ë° ìŠµê´€ì„ ì¶”ì •í•©ë‹ˆë‹¤.
                        <br><span class="text-xs text-neutral-400">(ê·¸ë˜í”„ê°€ ë°”ê¹¥ìª½ìœ¼ë¡œ ë„“ì„ìˆ˜ë¡ í•´ë‹¹ ìœ„í—˜ë„ê°€ ë†’ìŠµë‹ˆë‹¤)</span>
                    </p>
                    <div class="flex-grow flex items-center justify-center">
                        <div class="chart-container">
                            <canvas id="riskRadarChart"></canvas>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Action Guide Section -->
            <div class="bg-white p-8 rounded-xl shadow-lg border-l-4 border-neutral-800">
                <h3 class="text-xl font-bold text-neutral-800 mb-6">ğŸ©º ë§ì¶¤í˜• í–‰ë™ ê°€ì´ë“œ</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h4 class="font-bold text-neutral-600 mb-3 flex items-center gap-2">
                            <span class="bg-neutral-100 p-1 rounded">ğŸ“‹</span> í˜„ì¬ ìƒíƒœ í•´ì„
                        </h4>
                        <div id="guide-interpretation" class="text-neutral-700 leading-relaxed bg-neutral-50 p-4 rounded-lg">
                            <!-- JS Injected -->
                        </div>
                    </div>
                    <div>
                        <h4 class="font-bold text-neutral-600 mb-3 flex items-center gap-2">
                            <span class="bg-neutral-100 p-1 rounded">ğŸš€</span> ì‹¤ì²œ ëª©í‘œ
                        </h4>
                        <div id="guide-action" class="text-neutral-700 leading-relaxed bg-neutral-50 p-4 rounded-lg">
                            <!-- JS Injected -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Detailed Risk List -->
            <div id="risk-details-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- JS injected warning cards for specific risks -->
            </div>

            <div class="text-center py-8">
                <button onclick="location.reload()" class="text-neutral-500 hover:text-neutral-800 underline">
                    ê²€ì‚¬ ë‹¤ì‹œí•˜ê¸°
                </button>
            </div>

        </div>

    </main>

    <script>
        // --- Data Structure ---
        // Questions array based on the source text. 
        // Scores generally: High frequency of bad habit = 2, Medium = 1, Good habit = 0.
        // Or: Low frequency of good habit = 2.
        
        const questions = [
            { id: 1, text: "ì•„ì¹¨ì„ ê±°ì˜ ë§¤ì¼ ë¨¹ì§€ ì•ŠëŠ”ë‹¤.", options: [ {label: "í•­ìƒ", score: 2}, {label: "ê°€ë”", score: 1}, {label: "ê±°ì˜ ì•ˆ í•¨ (ë§¤ì¼ ë¨¹ìŒ)", score: 0} ] },
            { id: 2, text: "í•˜ë£¨ì— ê³¼ì¼ì„ í•œ ê°œ(ë˜ëŠ” 1ì¸ë¶„)ë„ ë¨¹ì§€ ì•ŠëŠ”ë‹¤.", options: [ {label: "ì˜ˆ (ì•ˆ ë¨¹ìŒ)", score: 2}, {label: "ê°€ë”", score: 1}, {label: "ì•„ë‹ˆì˜¤ (ë§¤ì¼ ë¨¹ìŒ)", score: 0} ] },
            { id: 3, text: "ì±„ì†Œ(ìƒ, ì¡°ë¦¬ í¬í•¨)ë¥¼ í•˜ë£¨ì— í•œ ë¼ë„ ë¨¹ì§€ ì•ŠëŠ”ë‹¤.", options: [ {label: "ì˜ˆ (ì•ˆ ë¨¹ìŒ)", score: 2}, {label: "ê°€ë”", score: 1}, {label: "ì•„ë‹ˆì˜¤ (ë§¤ì¼ ë¨¹ìŒ)", score: 0} ] },
            { id: 4, text: "ê°€ê³µì‹í’ˆ(ë¼ë©´, ì¸ìŠ¤í„´íŠ¸, í¸ì˜ì ì‹ ë“±)ì„ ê±°ì˜ ë§¤ì¼ ì„­ì·¨í•œë‹¤.", options: [ {label: "í•­ìƒ", score: 2}, {label: "ì£¼ 2~4íšŒ", score: 1}, {label: "ì£¼ 1íšŒ ì´í•˜", score: 0} ] },
            { id: 5, text: "ë¬¼(ë¬¼, ë¬´ê°€ë‹¹ ì°¨ ë“±) ì„­ì·¨ëŸ‰ì´ í•˜ë£¨ 1ë¦¬í„° ë¯¸ë§Œì´ë‹¤.", options: [ {label: "ì˜ˆ (<1L)", score: 2}, {label: "1~1.5L", score: 1}, {label: "1.5L ì´ìƒ", score: 0} ] },
            { id: 6, text: "ë‹¨ ìŒë£Œ(íƒ„ì‚°/ê³¼ì¼ì£¼ìŠ¤/ì—ë„ˆì§€ ë“œë§í¬)ë¥¼ ê±°ì˜ ë§¤ì¼ ë§ˆì‹ ë‹¤.", options: [ {label: "ì˜ˆ", score: 2}, {label: "ì£¼ 2~4íšŒ", score: 1}, {label: "ê±°ì˜ ì•ˆ ë§ˆì‹¬", score: 0} ] },
            { id: 7, text: "ìœ¡ë¥˜, ìƒì„ , ë‹¬ê±€, ì½©ë¥˜ ë“± ë‹¨ë°±ì§ˆ ì‹í’ˆì„ í•˜ë£¨ 1íšŒë„ ëª» ë¨¹ëŠ”ë‹¤.", options: [ {label: "ì˜ˆ (ëª» ë¨¹ìŒ)", score: 2}, {label: "ê°€ë”", score: 1}, {label: "ì•„ë‹ˆìš” (1íšŒ ì´ìƒ ì„­ì·¨)", score: 0} ] },
            { id: 8, text: "ìœ ì œí’ˆ(ìš°ìœ /ìš”ê±°íŠ¸/ì¹˜ì¦ˆ)ì„ ê±°ì˜ ì „í˜€ ì„­ì·¨í•˜ì§€ ì•ŠëŠ”ë‹¤.", options: [ {label: "ì˜ˆ (ì•ˆ ë¨¹ìŒ)", score: 2}, {label: "ê°€ë”", score: 1}, {label: "ì•„ë‹ˆìš” (ê·œì¹™ì  ì„­ì·¨)", score: 0} ] },
            { id: 9, text: "ê°„ì‹(ê³¼ì, êµ°ê²ƒì§ˆ)ì„ í•˜ë£¨ 2ë²ˆ ì´ìƒ ë¨¹ëŠ”ë‹¤.", options: [ {label: "ì˜ˆ (2íšŒ ì´ìƒ)", score: 2}, {label: "1ë²ˆ", score: 1}, {label: "ê±°ì˜ ì•ˆ ë¨¹ìŒ", score: 0} ] },
            { id: 10, text: "í•˜ë£¨ì— ì±„ì†Œ, ê³¼ì¼ì„ í•©ì³ ì´ 3ì¸ë¶„ ë¯¸ë§Œ ì„­ì·¨í•œë‹¤.", options: [ {label: "ì˜ˆ (<3ì¸ë¶„)", score: 2}, {label: "3~4ì¸ë¶„", score: 1}, {label: "5ì¸ë¶„ ì´ìƒ", score: 0} ] },
            { id: 11, text: "ì €ë…ì„ ë§ì´(ê³¼ì‹) ë¨¹ê±°ë‚˜ ì•¼ì‹ìœ¼ë¡œ ì¸ìŠ¤í„´íŠ¸ë¥¼ ìì£¼ ë¨¹ëŠ”ë‹¤.", options: [ {label: "ì˜ˆ", score: 2}, {label: "ê°€ë”", score: 1}, {label: "ê±°ì˜ ì•ˆ í•¨", score: 0} ] },
            { id: 12, text: "ì²´ì¤‘ì´ ìµœê·¼(3ê°œì›” ë‚´) ê¸‰ê²©íˆ ê°ì†Œ ë˜ëŠ” ì¦ê°€í–ˆë‹¤(5% ì´ìƒ).", options: [ {label: "ì˜ˆ", score: 2}, {label: "ì•½ê°„ (3~5%)", score: 1}, {label: "ì•„ë‹ˆìš”", score: 0} ] },
            { id: 13, text: "ì†/ë°œí†±ì˜ ì•½í™”, ì‰½ê²Œ ë©ë“¦, ì‡ëª¸ ì¶œí˜ˆ ê°™ì€ ì˜ì–‘ê²°í• ì˜ì‹¬ ì¦ìƒì´ ìˆë‹¤.", options: [ {label: "ì—¬ëŸ¬ ì¦ìƒ", score: 2}, {label: "í•œë‘ ê°€ì§€", score: 1}, {label: "ì¦ìƒ ì—†ìŒ", score: 0} ] },
            { id: 14, text: "í•˜ë£¨ ì¤‘ ì‹ì‚¬ ì‹œê°„ ë¶ˆê·œì¹™(ë¼ë‹ˆ ê±°ë¥´ê¸°, ì‹œê°„ ë“¤ì‘¥)ì´ ì‹¬í•˜ë‹¤.", options: [ {label: "ë§¤ìš° ë¶ˆê·œì¹™", score: 2}, {label: "ê°€ë” ë¶ˆê·œì¹™", score: 1}, {label: "ê·œì¹™ì ", score: 0} ] },
            { id: 15, text: "í–‡ë¹› ë…¸ì¶œì´ ê±°ì˜ ì—†ì–´(ì‹¤ë‚´ í™œë™ ìœ„ì£¼) ì£¼ 2íšŒ ë¯¸ë§Œ í–‡ë¹›ì„ ì¬”ë‹¤.", options: [ {label: "ì˜ˆ (<2íšŒ)", score: 2}, {label: "ì£¼ 2~4íšŒ", score: 1}, {label: "ì£¼ 5íšŒ ì´ìƒ", score: 0} ] },
            { id: 16, text: "ë¹„íƒ€ë¯¼, ë¬´ê¸°ì§ˆ ë³´ì¶©ì œë¥¼ ë§¤ì¼ ë³µìš©í•˜ê³  ìˆë‹¤(ì˜ì‚¬ì˜ ì§€ì‹œ ì—†ì´).", options: [ {label: "í•­ìƒ", score: 1}, {label: "ê°€ë”/ì•ˆí•¨", score: 0} ] }, // Note: Source says 1 point for Always, 0 for Sometimes. A bit counter-intuitive but following source logic strictly.
            { id: 17, text: "ì†Œí™”ë¶ˆëŸ‰, ë³µí†µ, ë³€ë¹„, ì„¤ì‚¬ ê°™ì€ ë§Œì„± ì†Œí™” ë¬¸ì œê°€ ìˆë‹¤(ì£¼ 1íšŒ ì´ìƒ).", options: [ {label: "ìì£¼", score: 2}, {label: "ê°€ë”", score: 1}, {label: "ì—†ìŒ", score: 0} ] },
            { id: 18, text: "ìˆ˜ë©´ì´ ë§¤ìš° ë¶ˆê·œì¹™í•˜ê³  ì•¼ê°„ ê°ì„±, ìˆ˜ë©´ë¶€ì¡±ì´ ì¦ë‹¤.", options: [ {label: "ë§¤ìš° ë¶ˆê·œì¹™", score: 2}, {label: "ê°€ë” ë¶ˆê·œì¹™", score: 1}, {label: "ê·œì¹™ì  ìˆ˜ë©´", score: 0} ] },
            { id: 19, text: "ì±„ì‹ ìœ„ì£¼(ìœ¡ë¥˜, ìœ ì œí’ˆ ê±°ì˜ ì„­ì·¨X)ì¸ë° ì˜ì–‘ë³´ì¶©, ëŒ€ì²´ì‹ ê³„íšì´ ì—†ë‹¤.", options: [ {label: "ì˜ˆ (ê³„íš ì—†ìŒ)", score: 2}, {label: "ì¼ë¶€ ìˆìŒ", score: 1}, {label: "ì•„ë‹ˆìš” (ì¶©ë¶„í•œ ê³„íš)", score: 0} ] },
            { id: 20, text: "ìµœê·¼ 6ê°œì›” ì´ë‚´ ì¥ê¸°ì  ì•½ë¬¼(í•­ìƒì œ ë“±) ë˜ëŠ” ë‹¤ì´ì–´íŠ¸ ì•½ì„ ë³µìš© ì¤‘ì´ë‹¤.", options: [ {label: "ì˜ˆ", score: 2}, {label: "ê°€ë”", score: 1}, {label: "ì•„ë‹ˆìš”", score: 0} ] }
        ];

        // Specific Risk Group Mappings (Question IDs)
        // Note: Q16 and Q20 don't fit perfectly into the named groups in source, but influence total score.
        const riskGroups = {
            iron: { title: "ì² ë¶„ ê²°í• ìœ„í—˜", ids: [2, 8, 12, 13], color: "rgba(239, 68, 68, 0.7)" }, // Red-ish
            vitD: { title: "ë¹„íƒ€ë¯¼D ë¶€ì¡±", ids: [15, 8], color: "rgba(245, 158, 11, 0.7)" }, // Orange-ish
            protein: { title: "ë‹¨ë°±ì§ˆ ë¶€ì¡±", ids: [7, 19], color: "rgba(59, 130, 246, 0.7)" }, // Blue-ish
            sugar: { title: "ë‹¹ë¥˜/ì—ë„ˆì§€ ê³¼ë‹¤", ids: [4, 6, 9, 11], color: "rgba(16, 185, 129, 0.7)" }, // Green-ish
            digestion: { title: "ì†Œí™”/í¡ìˆ˜ ë¬¸ì œ", ids: [17, 12], color: "rgba(139, 92, 246, 0.7)" } // Purple-ish
        };

        let userAnswers = {};

        // --- Core Logic ---

        function startSurvey() {
            document.getElementById('intro-view').classList.add('hidden');
            document.getElementById('survey-view').classList.remove('hidden');
            renderQuestions();
        }

        function renderQuestions() {
            const container = document.getElementById('questions-container');
            container.innerHTML = '';

            questions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = "bg-white p-6 rounded-xl shadow border border-neutral-100 transition-all";
                card.id = `q-card-${q.id}`;
                
                let optionsHtml = '';
                q.options.forEach((opt, optIndex) => {
                    optionsHtml += `
                        <button 
                            onclick="selectOption(${q.id}, ${opt.score}, this)" 
                            class="option-btn w-full text-left px-4 py-3 rounded-lg border border-neutral-200 text-neutral-600 mb-2 hover:bg-neutral-50 focus:outline-none"
                        >
                            <div class="flex justify-between items-center">
                                <span>${opt.label}</span>
                                <span class="text-xs font-bold text-neutral-300 bg-neutral-100 px-2 py-1 rounded hidden debug-score">${opt.score}ì </span>
                            </div>
                        </button>
                    `;
                });

                card.innerHTML = `
                    <div class="flex items-start gap-3">
                        <span class="bg-neutral-800 text-white text-xs font-bold px-2 py-1 rounded-md mt-1">Q${index + 1}</span>
                        <h3 class="text-lg font-medium text-neutral-800 leading-snug">${q.text}</h3>
                    </div>
                    <div class="mt-4 grid grid-cols-1 gap-2">
                        ${optionsHtml}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function selectOption(qId, score, btnElement) {
            userAnswers[qId] = score;

            // Visual update
            const parent = document.getElementById(`q-card-${qId}`);
            const buttons = parent.querySelectorAll('.option-btn');
            buttons.forEach(b => {
                b.classList.remove('selected-option', 'ring-2', 'ring-neutral-800');
                b.classList.add('border-neutral-200', 'text-neutral-600');
            });

            btnElement.classList.remove('border-neutral-200', 'text-neutral-600');
            btnElement.classList.add('selected-option', 'ring-2', 'ring-neutral-800');

            updateProgress();
        }

        function updateProgress() {
            const answeredCount = Object.keys(userAnswers).length;
            const total = questions.length;
            const percentage = (answeredCount / total) * 100;
            
            document.getElementById('progress-bar').style.width = `${percentage}%`;
            document.getElementById('progress-text').innerText = `${answeredCount}/${total}`;

            if (answeredCount === total) {
                document.getElementById('submit-btn').classList.remove('hidden');
                document.getElementById('incomplete-msg').classList.add('hidden');
            }
        }

        function calculateAndShowResults() {
            const totalQuestions = questions.length;
            if (Object.keys(userAnswers).length < totalQuestions) {
                document.getElementById('incomplete-msg').classList.remove('hidden');
                // Optional: Scroll to first unanswered question logic could go here
                return;
            }

            // Calculate Total Score
            let totalScore = 0;
            Object.values(userAnswers).forEach(s => totalScore += s);

            // Calculate Risk Groups
            let riskAnalysis = {};
            for (const [key, group] of Object.entries(riskGroups)) {
                let groupScore = 0;
                let maxGroupScore = 0;
                group.ids.forEach(qid => {
                    groupScore += userAnswers[qid] || 0;
                    // Find max score for this question (usually 2, sometimes 1 for Q16)
                    const qData = questions.find(q => q.id === qid);
                    const maxQScore = Math.max(...qData.options.map(o => o.score));
                    maxGroupScore += maxQScore;
                });
                // Normalize to 0-100 for Radar Chart
                riskAnalysis[key] = {
                    score: groupScore,
                    percentage: (groupScore / maxGroupScore) * 100,
                    title: group.title
                };
            }

            // Render Dashboard
            document.getElementById('survey-view').classList.add('hidden');
            document.getElementById('dashboard-view').classList.remove('hidden');
            window.scrollTo(0, 0);

            renderTotalScoreChart(totalScore);
            renderRiskRadarChart(riskAnalysis);
            updateTextContent(totalScore, riskAnalysis);
        }

        // --- Visualization Logic ---

        function renderTotalScoreChart(score) {
            const ctx = document.getElementById('scoreChart').getContext('2d');
            document.getElementById('total-score-display').innerText = score;
            
            // Determine Color
            let color = '#48BB78'; // Green
            if (score >= 14) color = '#ED8936'; // Orange
            if (score >= 27) color = '#E53E3E'; // Red

            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['ë‚´ ì ìˆ˜', 'ë‚¨ì€ ì ìˆ˜'],
                    datasets: [{
                        data: [score, 40 - score],
                        backgroundColor: [color, '#E2E8F0'],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    circumference: 180,
                    rotation: -90,
                    cutout: '80%',
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    }
                }
            });
        }

        function renderRiskRadarChart(riskData) {
            const ctx = document.getElementById('riskRadarChart').getContext('2d');
            
            const labels = Object.values(riskData).map(d => d.title);
            const data = Object.values(riskData).map(d => d.percentage);

            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ìœ„í—˜ë„ (%)',
                        data: data,
                        fill: true,
                        backgroundColor: 'rgba(237, 137, 54, 0.2)', // Orange tint
                        borderColor: 'rgba(237, 137, 54, 1)',
                        pointBackgroundColor: 'rgb(237, 137, 54)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(237, 137, 54)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    elements: {
                        line: { borderWidth: 2 }
                    },
                    scales: {
                        r: {
                            angleLines: { display: true },
                            suggestedMin: 0,
                            suggestedMax: 100,
                            ticks: { display: false } // Hide numbers on axis for cleaner look
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function updateTextContent(score, riskAnalysis) {
            const msgContainer = document.getElementById('score-message-container');
            const guideInterp = document.getElementById('guide-interpretation');
            const guideAction = document.getElementById('guide-action');
            const riskDetails = document.getElementById('risk-details-container');

            let statusTitle, statusColor, interpText, actionText;

            // Logic based on Source Report
            if (score <= 13) {
                statusTitle = "ì˜ì–‘ ìœ„í—˜ ë‚®ìŒ (ì–‘í˜¸)";
                statusColor = "text-brand-green";
                msgContainer.innerHTML = `<h4 class="text-xl font-bold ${statusColor}">${statusTitle}</h4><p class="text-sm text-neutral-600">ëŒ€ì²´ë¡œ ì‹ìƒí™œ ê· í˜•ì´ ì˜ ì¡í˜€ìˆìŠµë‹ˆë‹¤!</p>`;
                interpText = "í˜„ì¬ í° ë¬¸ì œëŠ” ì—†ìœ¼ë‚˜, ì¼ë¶€ ì†Œí™€í•  ìˆ˜ ìˆëŠ” í•­ëª©ë“¤(ìˆ˜ë©´, ìˆ˜ë¶„ ë“±)ì„ ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì“´ë‹¤ë©´ ìµœìƒì˜ ì»¨ë””ì…˜ì„ ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                actionText = `
                    <ul class="list-disc pl-5 space-y-2">
                        <li><b>ìœ ì§€í•˜ê¸°:</b> í˜„ì¬ì˜ ì¢‹ì€ ì‹ìŠµê´€ ëª©ë¡ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”.</li>
                        <li><b>ë¯¸ì„¸ ì¡°ì •:</b> ì•„ì¹¨ ì±™ê¸°ê¸°ë‚˜ ì±„ì†Œ í•œ ì ‘ì‹œ ë” ë¨¹ê¸° ê°™ì€ ì†Œì†Œí•œ ëª©í‘œë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”.</li>
                        <li><b>ì§€ì†ì„±:</b> ë°©ì‹¬í•˜ì§€ ë§ê³  í˜„ì¬ íŒ¨í„´ì„ ë£¨í‹´í™”í•˜ì„¸ìš”.</li>
                    </ul>
                `;
            } else if (score <= 26) {
                statusTitle = "ê±´ê°• ì˜ë¡œì¹´ë“œ (ì£¼ì˜ í•„ìš”)";
                statusColor = "text-brand-orange";
                msgContainer.innerHTML = `<h4 class="text-xl font-bold ${statusColor}">${statusTitle}</h4><p class="text-sm text-neutral-600">ì˜ì–‘ ë¶ˆê· í˜• ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.</p>`;
                interpText = "íŠ¹ì • ì˜ì–‘ì†Œì˜ ë¶€ì¡±ì´ ìš°ë ¤ë©ë‹ˆë‹¤. ë°©ì¹˜í•  ê²½ìš° ë§Œì„±ì ì¸ í”¼ë¡œê°ì´ë‚˜ ì»¨ë””ì…˜ ì €í•˜ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìƒí™œìŠµê´€ ì „ë°˜ì˜ ì ê²€ì´ í•„ìš”í•œ ì‹œì ì…ë‹ˆë‹¤.";
                actionText = `
                    <ul class="list-disc pl-5 space-y-2">
                        <li><b>ì‹ë‹¨ ì¼ì§€:</b> ì£¼ 1íšŒ, ë¬´ì—‡ì„ ì–¸ì œ ë¨¹ì—ˆëŠ”ì§€ ê¸°ë¡í•´ë³´ì„¸ìš”.</li>
                        <li><b>ëª©í‘œ ì„¤ì •:</b> ë¶€ì¡±í•˜ê¸° ì‰¬ìš´ ì˜ì–‘ì†Œ(ë‹¨ë°±ì§ˆ, ì¹¼ìŠ˜, ë¹„íƒ€ë¯¼D) ë³´ì¶© ê³„íšì„ ì„¸ìš°ì„¸ìš”.</li>
                        <li><b>ë³´ì¡°ì œ ê³ ë ¤:</b> í•„ìš”í•˜ë‹¤ë©´ ì „ë¬¸ê°€ì™€ ìƒë‹´ í›„ ì˜ì–‘ì œ ì„­ì·¨ë¥¼ ê³ ë ¤í•˜ì„¸ìš”.</li>
                    </ul>
                `;
            } else {
                statusTitle = "ì˜ì–‘ ë¶ˆê· í˜• ìœ„í—˜ (ë¹„ìƒ)";
                statusColor = "text-brand-red";
                msgContainer.innerHTML = `<h4 class="text-xl font-bold ${statusColor}">${statusTitle}</h4><p class="text-sm text-neutral-600">ì¦‰ê°ì ì¸ ì¡°ì¹˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>`;
                interpText = "ì˜ì–‘ ë¶ˆê· í˜• ì •ë„ê°€ ë†’ìŠµë‹ˆë‹¤. ì‹ ì²´ì  ì¦ìƒ(ë§Œì„± í”¼ë¡œ, ì†Œí™” ë¬¸ì œ ë“±)ì´ ì´ë¯¸ ë‚˜íƒ€ë‚˜ê³  ìˆì„ ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤. ìê°€ ë…¸ë ¥ë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                actionText = `
                    <ul class="list-disc pl-5 space-y-2">
                        <li><b>ì „ë¬¸ê°€ ìƒë‹´:</b> ì˜ì‚¬, ì˜ì–‘ì‚¬ ë“± ì „ë¬¸ê°€ì™€ì˜ ìƒë‹´ì„ ê°•ë ¥íˆ ê¶Œì¥í•©ë‹ˆë‹¤.</li>
                        <li><b>í˜ˆì•¡ ê²€ì‚¬:</b> ë¹ˆí˜ˆ, í˜ˆë‹¹, ë¹„íƒ€ë¯¼D ìˆ˜ì¹˜ ë“±ì„ í™•ì¸í•´ë³´ì„¸ìš”.</li>
                        <li><b>íŒ¨í„´ ë¦¬ì…‹:</b> ê°€ê³µì‹í’ˆì„ ëŠê³  ë¼ë‹ˆ ì‹œê°„ì„ ê·œì¹™ì ìœ¼ë¡œ ë§ì¶”ëŠ” ê²ƒë¶€í„° ì‹œì‘í•˜ì„¸ìš”.</li>
                    </ul>
                `;
            }

            guideInterp.innerHTML = interpText;
            guideAction.innerHTML = actionText;

            // Generate Risk Detail Cards
            riskDetails.innerHTML = '';
            for (const [key, data] of Object.entries(riskAnalysis)) {
                if (data.percentage >= 50) { // If risk score is high (>50%)
                    const div = document.createElement('div');
                    div.className = "bg-red-50 p-4 rounded-lg border border-red-100 flex items-start gap-3";
                    div.innerHTML = `
                        <div class="text-2xl">âš ï¸</div>
                        <div>
                            <h5 class="font-bold text-red-800">${data.title} ì£¼ì˜</h5>
                            <p class="text-xs text-red-600 mt-1">í•´ë‹¹ í•­ëª© ê´€ë ¨ ë¬¸í•­ ì ìˆ˜ê°€ ë†’ìŠµë‹ˆë‹¤. ê´€ë ¨ ì‹í’ˆ ì„­ì·¨ë¥¼ ì ê²€í•˜ì„¸ìš”.</p>
                        </div>
                    `;
                    riskDetails.appendChild(div);
                }
            }
            if (riskDetails.innerHTML === '') {
                 const div = document.createElement('div');
                    div.className = "bg-green-50 p-4 rounded-lg border border-green-100 col-span-full text-center";
                    div.innerHTML = `
                        <h5 class="font-bold text-green-800">íŠ¹ì • ìœ„í—˜êµ° ë°œê²¬ë˜ì§€ ì•ŠìŒ</h5>
                        <p class="text-sm text-green-600 mt-1">íŠ¹ì • ì˜ì–‘ì†Œì— ì¹˜ìš°ì¹œ ê²°í• ì§•í›„ëŠ” ë³´ì´ì§€ ì•ŠìŠµë‹ˆë‹¤. í›Œë¥­í•©ë‹ˆë‹¤!</p>
                    `;
                    riskDetails.appendChild(div);
            }
        }

    </script>
</body>
</html>